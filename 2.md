# Лекция 2

## База

Что такие тип и зачем?

**Тип** - спецификация работы с набором битов.

Фундаментальные **типы** задаются архитектурами процессоров

**Ссылочный тип**: тип, значение которого содержит ссылку на его данные. Значение описываемое ссылочным типом указывает месторасположение другого значения.

## Value Type | Reference type

Stack:

    1) Содержит информацию о выполняемом потоке, цепочку вызванных методов, обьявление локальных переменных
    2) При вызове конструктора структуры происходит выделение памяти на стеке под нее

Heap

    1) Место, куда скидываются экземпляры 
    2) Больше места чем в стеке
    3) Встроенный рантмайт механизм выделения памяти по запросу
    4) Встроенный механизм по очистке данных

Boxing

    1) Процесс упаковки со стека на кучу
    2) Во время боксинга для value type выделяется память на куче, он переносится туда

# System.Object

Базовый тип, от которого наследуются все другие

**Дефолтные методы:**

1) ToString - возвращает имя типа
2) Equals - для ссылочных типов сравнивает ссылки, для типов значений сравнивается значение полей.
3) GetHashCode - возвращает хэш-код текущего обьекта основываясь на ссылку на обьект

## Value types

1) Тоже наследуется от object.
2) А значит может использоваться в нашей коллекции.

## JVM moment: object and struct

1) Нет структур, нельзя объявить пользовательский не референсный
    тип.
2) Примитивы отдельно от объектов.
3) Integer / int
4) Project Valhalla

## System.Enum

    1)Именованные инты.
    2)Чуть более понятные битовые операции.
    3)По дефолту нет проверки на безопасность типа.
    4)Значения без методов :с (но это поправимо!)

## Discriminated Unions

**DU** - это сумма типов, в отличии от Tuple, который является
произведением типов

## Records

Records представляют новый ссылочный тип, который появился в C#9. Ключевая особенность records состоит в том, что они могут представлять неизменяемый (immutable) тип, который по умолчанию обладает рядом дополнительных возможностей по сравнению с классами и структурами.

## Immutable types

Props:

    1) Проще следить за состоянием объекта
    2) Нет проблем с тем, что мы завязались на состояние, которое
    изменилось (например, GetHashCode)
Cons:

    1) Сложно реализовать в языках, где изначально нет
    иммутабельности
    2) Аллокации, перфоманс

## Immutable strings

1) Строки - концептуально не изменяемый тип
2) Операции над строками = создание новой строки
3) StringBuilder

## Generics

1) Меньше дублирования кода
2) Перфоманс
3) Проверки типов во время компиляции

## LINQ

**IEnumerable**

    1) Базовый интерфейс для всех перечислений.
    2) IEnumerable / IEnumerator
    3) Большие иерархии: IEnumerable -> ICollection -> IList -> List

**First-class type**

    1)Может быть параметром функции.
    2)Может быть возвращаемым значением функции.
    3)Может быть объектом присвоения.
    4)Может сравниваться.

**Delegates, Action, Func**

1) Делегат – это объект, который знает, как вызывать метод.
2) Func – это заранее созданные делегаты.
3) Action – это костыль над отсутствием Unit.

**Lambda expressions**

1) Лямбды – это делегаты.
2) Вывод типов в шарпе работает не так хорошо, как хочется.
3) Лямбды тесно связаны с механизмом замыкания.